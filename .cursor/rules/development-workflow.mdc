---
description:
globs:
alwaysApply: false
---
# Natter Web å¼€å‘å·¥ä½œæµè§„åˆ™

## ğŸš€ å¼€å‘ç¯å¢ƒè®¾ç½®

### å‰ç½®è¦æ±‚
```bash
# Python ç¯å¢ƒ
Python 3.8+
pip install psutil flask

# Node.js ç¯å¢ƒ (å¯é€‰ï¼Œç”¨äºå‰ç«¯å·¥å…·)
Node.js 16+
npm install -g live-server  # æœ¬åœ°å¼€å‘æœåŠ¡å™¨

# Git é…ç½®
git config --global user.name "Your Name"
git config --global user.email "your.email@example.com"
```

### é¡¹ç›®åˆå§‹åŒ–
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/Await-d/natter-web.git
cd natter-web

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ (æ¨è)
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ– venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

## ğŸ”„ å¼€å‘æµç¨‹

### 1. åŠŸèƒ½å¼€å‘æµç¨‹
```mermaid
graph LR
    A[åˆ›å»ºFeatureåˆ†æ”¯] --> B[ç¼–å†™ä»£ç ]
    B --> C[æœ¬åœ°æµ‹è¯•]
    C --> D[æäº¤ä»£ç ]
    D --> E[æ¨é€åˆ†æ”¯]
    E --> F[åˆ›å»ºPR]
    F --> G[ä»£ç å®¡æŸ¥]
    G --> H[åˆå¹¶ä¸»åˆ†æ”¯]
```

### 2. Git åˆ†æ”¯ç­–ç•¥
```bash
# ä¸»åˆ†æ”¯
main/master     # ç”Ÿäº§ç¯å¢ƒä»£ç 
develop         # å¼€å‘ç¯å¢ƒä»£ç 

# åŠŸèƒ½åˆ†æ”¯
feature/ui-redesign
feature/iyuu-notification
feature/service-templates

# ä¿®å¤åˆ†æ”¯
hotfix/critical-bug-fix
bugfix/minor-issue-fix

# å‘å¸ƒåˆ†æ”¯
release/v1.0.5
```

### 3. æäº¤ä¿¡æ¯è§„èŒƒ
```bash
# æäº¤ç±»å‹
feat:     æ–°åŠŸèƒ½
fix:      bugä¿®å¤
docs:     æ–‡æ¡£æ›´æ–°
style:    ä»£ç æ ¼å¼åŒ–
refactor: ä»£ç é‡æ„
test:     æµ‹è¯•ç›¸å…³
chore:    æ„å»ºå·¥å…·ç­‰

# ç¤ºä¾‹
git commit -m "feat: æ·»åŠ æœåŠ¡æ¨¡æ¿ä¿å­˜åŠŸèƒ½"
git commit -m "fix: ä¿®å¤æœåŠ¡çŠ¶æ€æ›´æ–°bug"
git commit -m "docs: æ›´æ–°APIæ–‡æ¡£"
git commit -m "style: ä¼˜åŒ–UIå¸ƒå±€å’ŒåŠ¨ç”»æ•ˆæœ"
```

## ğŸ§ª æµ‹è¯•è§„èŒƒ

### å•å…ƒæµ‹è¯•
```python
# æµ‹è¯•æ–‡ä»¶å‘½å: test_*.py
# ä½ç½®: tests/ ç›®å½•

import unittest
from web.server import NatterWebServer

class TestServiceManager(unittest.TestCase):
    def setUp(self):
        """æµ‹è¯•å‰ç½®è®¾ç½®"""
        self.server = NatterWebServer()
        self.server.config['TESTING'] = True
        self.client = self.server.app.test_client()
    
    def test_create_service(self):
        """æµ‹è¯•åˆ›å»ºæœåŠ¡"""
        response = self.client.post('/api/services', 
                                  json={'target_port': 8080})
        self.assertEqual(response.status_code, 201)
    
    def tearDown(self):
        """æµ‹è¯•åæ¸…ç†"""
        # æ¸…ç†æµ‹è¯•æ•°æ®
        pass

# è¿è¡Œæµ‹è¯•
python -m pytest tests/ -v
```

### å‰ç«¯æµ‹è¯•
```javascript
// ä½¿ç”¨ Jest è¿›è¡Œå‰ç«¯æµ‹è¯•
describe('ServiceCard Component', () => {
    beforeEach(() => {
        // è®¾ç½®æµ‹è¯•ç¯å¢ƒ
        document.body.innerHTML = '<div id="app"></div>';
    });
    
    test('åº”è¯¥æ­£ç¡®æ¸²æŸ“æœåŠ¡ä¿¡æ¯', () => {
        const serviceData = {
            id: 'test-service',
            name: 'Test Service',
            status: 'running'
        };
        
        const card = new ServiceCard(serviceData);
        expect(card.element.textContent).toContain('Test Service');
    });
    
    afterEach(() => {
        // æ¸…ç†DOM
        document.body.innerHTML = '';
    });
});
```

### é›†æˆæµ‹è¯•
```python
# APIé›†æˆæµ‹è¯•
def test_service_lifecycle():
    """æµ‹è¯•æœåŠ¡å®Œæ•´ç”Ÿå‘½å‘¨æœŸ"""
    # 1. åˆ›å»ºæœåŠ¡
    create_response = client.post('/api/services', json=test_config)
    service_id = create_response.json['id']
    
    # 2. è·å–æœåŠ¡çŠ¶æ€
    status_response = client.get(f'/api/services/{service_id}')
    assert status_response.status_code == 200
    
    # 3. åˆ é™¤æœåŠ¡
    delete_response = client.delete(f'/api/services/{service_id}')
    assert delete_response.status_code == 204
```

## ğŸ¨ UI/UX å¼€å‘æµç¨‹

### è®¾è®¡è§„èŒƒæ£€æŸ¥æ¸…å•
- [ ] ç¬¦åˆæš—è‰²ä¸»é¢˜è®¾è®¡
- [ ] ä½¿ç”¨ç»Ÿä¸€çš„é¢œè‰²å˜é‡
- [ ] å“åº”å¼è®¾è®¡é€‚é…
- [ ] åŠ¨ç”»æ•ˆæœæµç•…
- [ ] å¯è®¿é—®æ€§æ”¯æŒ
- [ ] æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•

### CSS å¼€å‘è§„èŒƒ
```css
/* 1. ä½¿ç”¨CSSå˜é‡ */
:root {
    --primary-color: #667eea;
    --secondary-color: #764ba2;
}

/* 2. BEMå‘½åè§„èŒƒ */
.service-card__header--active {}

/* 3. ç§»åŠ¨ä¼˜å…ˆå“åº”å¼è®¾è®¡ */
.container {
    /* ç§»åŠ¨ç«¯æ ·å¼ */
}

@media (min-width: 768px) {
    .container {
        /* æ¡Œé¢ç«¯æ ·å¼ */
    }
}

/* 4. ä½¿ç”¨é€»è¾‘å±æ€§ */
margin-inline-start: 1rem;  /* æ›¿ä»£ margin-left */
```

### JavaScript å¼€å‘è§„èŒƒ
```javascript
// 1. ä½¿ç”¨ç°ä»£ES6+è¯­æ³•
const { serviceManager } = await import('./modules/service-manager.js');

// 2. å¼‚æ­¥æ“ä½œä½¿ç”¨async/await
async function updateServiceStatus(serviceId) {
    try {
        const response = await fetch(`/api/services/${serviceId}`);
        if (!response.ok) throw new Error('è¯·æ±‚å¤±è´¥');
        const data = await response.json();
        return data;
    } catch (error) {
        console.error('æ›´æ–°æœåŠ¡çŠ¶æ€å¤±è´¥:', error);
        throw error;
    }
}

// 3. ä½¿ç”¨äº‹ä»¶å§”æ‰˜
document.addEventListener('click', (event) => {
    if (event.target.matches('.service-card__action-btn')) {
        handleServiceAction(event);
    }
});

// 4. é˜²æŠ–å’ŒèŠ‚æµ
const debouncedSearch = debounce((query) => {
    performSearch(query);
}, 300);
```

## ğŸ” ä»£ç å®¡æŸ¥è§„èŒƒ

### å®¡æŸ¥æ£€æŸ¥æ¸…å•

#### åŠŸèƒ½æ€§
- [ ] åŠŸèƒ½æ˜¯å¦æŒ‰é¢„æœŸå·¥ä½œ
- [ ] è¾¹ç•Œæ¡ä»¶å¤„ç†æ˜¯å¦æ­£ç¡®
- [ ] é”™è¯¯å¤„ç†æ˜¯å¦å®Œå–„
- [ ] æ€§èƒ½æ˜¯å¦å¯æ¥å—

#### ä»£ç è´¨é‡
- [ ] ä»£ç é€»è¾‘æ¸…æ™°æ˜“æ‡‚
- [ ] å‘½åè§„èŒƒä¸€è‡´
- [ ] æ³¨é‡Šå……åˆ†ä¸”å‡†ç¡®
- [ ] æ²¡æœ‰é‡å¤ä»£ç 

#### å®‰å…¨æ€§
- [ ] è¾“å…¥éªŒè¯æ˜¯å¦å……åˆ†
- [ ] æ²¡æœ‰XSS/CSRFæ¼æ´
- [ ] APIæƒé™æ§åˆ¶æ­£ç¡®
- [ ] æ•æ„Ÿä¿¡æ¯æ²¡æœ‰æ³„éœ²

#### UI/UX
- [ ] ç•Œé¢ç¾è§‚ä¸€è‡´
- [ ] äº¤äº’é€»è¾‘åˆç†
- [ ] å“åº”å¼è®¾è®¡æ­£ç¡®
- [ ] å¯è®¿é—®æ€§æ”¯æŒ

### å®¡æŸ¥è¯„è®ºç¤ºä¾‹
```markdown
# å¥½çš„è¯„è®º
âœ… å»ºè®®ï¼šè¿™é‡Œå¯ä»¥ä½¿ç”¨CSS Gridæ¥ç®€åŒ–å¸ƒå±€ä»£ç 
âœ… å®‰å…¨ï¼šå»ºè®®å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡ŒXSSè¿‡æ»¤
âœ… æ€§èƒ½ï¼šè¿™ä¸ªå¾ªç¯å¯ä»¥ä¼˜åŒ–ï¼Œå»ºè®®ä½¿ç”¨Mapä»£æ›¿å¤šæ¬¡æŸ¥æ‰¾

# é¿å…çš„è¯„è®º
âŒ è¿™æ®µä»£ç ä¸å¥½
âŒ æ”¹ä¸€ä¸‹
âŒ æœ‰é—®é¢˜
```

## ğŸ“¦ æ„å»ºå’Œéƒ¨ç½²

### æœ¬åœ°å¼€å‘
```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
cd web
python server.py 8080

# æˆ–ä½¿ç”¨Docker
docker-compose up -d

# å‰ç«¯çƒ­é‡è½½ (å¯é€‰)
npx live-server web/ --port=3000
```

### ç”Ÿäº§æ„å»º
```bash
# ä¼˜åŒ–CSS
npm run build:css

# å‹ç¼©JavaScript
npm run build:js

# æ„å»ºDockeré•œåƒ
docker build -t natter-web:latest .

# æ¨é€åˆ°ä»“åº“
docker push your-registry/natter-web:latest
```

### CI/CD æµæ°´çº¿
```yaml
# .drone.yml
kind: pipeline
type: docker
name: default

steps:
- name: test
  image: python:3.9
  commands:
  - pip install -r requirements.txt
  - python -m pytest

- name: build
  image: plugins/docker
  settings:
    repo: your-registry/natter-web
    tags: [ latest, "${DRONE_TAG}" ]

trigger:
  branch:
  - main
  - develop
```

## ğŸ› è°ƒè¯•æŠ€å·§

### åç«¯è°ƒè¯•
```python
# ä½¿ç”¨å†…ç½®è°ƒè¯•å™¨
import pdb; pdb.set_trace()

# ä½¿ç”¨æ—¥å¿—è°ƒè¯•
import logging
logging.basicConfig(level=logging.DEBUG)
logger = logging.getLogger(__name__)
logger.debug(f"æœåŠ¡çŠ¶æ€: {service.status}")

# Flaskè°ƒè¯•æ¨¡å¼
app.run(debug=True)
```

### å‰ç«¯è°ƒè¯•
```javascript
// ä½¿ç”¨consoleè°ƒè¯•
console.log('æœåŠ¡æ•°æ®:', serviceData);
console.table(services);  // è¡¨æ ¼å½¢å¼æ˜¾ç¤ºæ•°ç»„

// ä½¿ç”¨æ–­ç‚¹
debugger;

// æ€§èƒ½åˆ†æ
console.time('æœåŠ¡åˆ—è¡¨æ¸²æŸ“');
renderServiceList();
console.timeEnd('æœåŠ¡åˆ—è¡¨æ¸²æŸ“');

// ç½‘ç»œè¯·æ±‚ç›‘æ§
fetch('/api/services')
    .then(response => {
        console.log('å“åº”çŠ¶æ€:', response.status);
        return response.json();
    });
```

### Docker è°ƒè¯•
```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs natter-web

# è¿›å…¥å®¹å™¨è°ƒè¯•
docker exec -it natter-web bash

# å®¹å™¨èµ„æºç›‘æ§
docker stats natter-web
```

## ğŸ“‹ å‘å¸ƒæ¸…å•

### å‘å¸ƒå‰æ£€æŸ¥
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä»£ç å®¡æŸ¥å®Œæˆ
- [ ] æ–‡æ¡£æ›´æ–°
- [ ] ç‰ˆæœ¬å·æ›´æ–°
- [ ] å˜æ›´æ—¥å¿—è®°å½•
- [ ] å®‰å…¨æ£€æŸ¥é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•

### å‘å¸ƒæ­¥éª¤
```bash
# 1. åˆ›å»ºå‘å¸ƒåˆ†æ”¯
git checkout -b release/v1.0.5

# 2. æ›´æ–°ç‰ˆæœ¬ä¿¡æ¯
echo "v1.0.5" > VERSION

# 3. ç”Ÿæˆå˜æ›´æ—¥å¿—
git log --oneline v1.0.4..HEAD > CHANGELOG.md

# 4. æäº¤å‘å¸ƒ
git add .
git commit -m "release: v1.0.5"

# 5. åˆå¹¶åˆ°ä¸»åˆ†æ”¯
git checkout main
git merge release/v1.0.5

# 6. åˆ›å»ºæ ‡ç­¾
git tag -a v1.0.5 -m "Release v1.0.5"

# 7. æ¨é€åˆ°è¿œç¨‹
git push origin main --tags
```

### å›æ»šç­–ç•¥
```bash
# å¿«é€Ÿå›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬
git checkout v1.0.4
docker pull your-registry/natter-web:v1.0.4
docker-compose up -d

# çƒ­ä¿®å¤
git checkout -b hotfix/critical-fix main
# ä¿®å¤ä»£ç ...
git merge hotfix/critical-fix
```

è®°ä½ï¼š**è´¨é‡ä¼˜äºé€Ÿåº¦ï¼Œç¨³å®šä¼˜äºåŠŸèƒ½ï¼** å§‹ç»ˆä¼˜å…ˆä¿è¯ä»£ç è´¨é‡å’Œç”¨æˆ·ä½“éªŒã€‚
